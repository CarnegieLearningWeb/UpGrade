<div class="users-container">
  <div class="user-wrapper">
    <div class="exclude-entities">
      <h3 class="exclude-entities--title">{{ 'users.excluded-entity.text' | translate }}</h3>
      <form class="exclude-form" [formGroup]="excludeEntitiesForm">

        <mat-form-field class="form-control">
          <mat-select formControlName="entityType">
            <mat-option
              *ngFor="let entity of entityTypes"
              [value]="entity.value"
            >
              {{ entity.value }}
            </mat-option>
          </mat-select>
        </mat-form-field>

        <mat-form-field class="form-control" *ngIf="entityTypeValue">
          <mat-select formControlName="groupType">
            <mat-option
              *ngFor="let groupType of groupTypes"
              [value]="groupType.value"
            >
              {{ groupType.value | titlecase }}
            </mat-option>
          </mat-select>
        </mat-form-field>

        <mat-form-field
          class="form-control"
          *ngIf="groupTypeValue"
        >
          <input
            matInput
            [placeholder]="'home.new-experiment.overview.group-custom-type.placeHolder' | translate"
            formControlName="customGroupName"
          />
        </mat-form-field>

        <mat-form-field class="form-control">
          <input
            matInput
            [placeholder]="'users.exclude-entity-form.id-placeholder.text' | translate"
            formControlName="id"
          />
        </mat-form-field>

        <button
          mat-raised-button
          class="default-button form-control"
          [ngClass]="{'default-button--disabled': !this.excludeEntitiesForm.valid}"
          [disabled]="!this.excludeEntitiesForm.valid || (isEntityLoading$ | async )"
          (click)="excludeEntity()"
        >
          <mat-icon *ngIf="isEntityLoading$ | async">
            <mat-spinner diameter="20"></mat-spinner>
          </mat-icon>
          {{ 'users.exclude-btn.text' | translate }}
        </button>

      </form>

      <div class="entities-container">
        <table mat-table [dataSource]="allExcludedEntities" matSort>

          <!-- TYPE Column -->
          <ng-container matColumnDef="type">
            <th mat-header-cell *matHeaderCellDef mat-sort-header class="table table-heading">
              {{ 'users.excluded-entities-table.type.text' | translate }}
            </th>
            <td mat-cell *matCellDef="let element"> {{ element.type ? (element.type | titlecase) : ('users-global.text' | translate) }} </td>
          </ng-container>

          <!-- ID Column -->
          <ng-container matColumnDef="id">
            <th mat-header-cell *matHeaderCellDef mat-sort-header class="table table-heading">
              {{ 'users.excluded-entities-table.id.text' | translate }}
            </th>
            <td mat-cell *matCellDef="let element"> {{ element.type ? element.groupId : element.userId }} </td>
          </ng-container>

          <tr mat-header-row *matHeaderRowDef="displayedColumns; sticky: true"></tr>
          <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
        </table>
        <mat-paginator class="paginator" [hidePageSize]="true" [pageSize]="7"></mat-paginator>
      </div>

    </div>
  </div>
</div>
