<div class="metric-common">
  <h3 class="ft-20-600">{{ 'home.new-experiment.metric.manage-metrics.text' | translate }}</h3>
  <div class="action-container">
    <mat-slide-toggle
        class="ft-16-600"
        color="primary"
        (change)="changeMetricMode($event)"
        labelPosition="before"
      >
        {{ 'home.new-experiment.metric.read-mode.text' | translate }}
      </mat-slide-toggle>
    <button
      mat-flat-button
      class="default-button"
      (click)="openAddNodeDialog()"
    >
      {{ 'home.new-experiment.metric.add-root-key.text' | translate }}
    </button>
  </div>

  <mat-tree
    [dataSource]="nestedDataSource"
    [treeControl]="nestedTreeControl"
    class="node-tree mat-tree-position"
  >
    <!-- Without Children -->
    <mat-tree-node *matTreeNodeDef="let node">
      <li class="mat-tree-node">
        <button mat-icon-button disabled></button>
        <span class="ft-14-600 key-name">{{ node.key }}</span>
        <ng-container *ngIf="keyEditMode">
          <mat-icon class="icon" (click)="openAddNodeDialog(node)"> add </mat-icon>
          <mat-icon class="icon" (click)="openEditNodeDialog(node)">edit</mat-icon>
          <mat-icon class="icon" (click)="deleteNode(node)">delete_outline</mat-icon>
        </ng-container>
      </li>
    </mat-tree-node>

    <!-- With Children -->
    <mat-nested-tree-node *matTreeNodeDef="let node; when: hasNestedChild">
      <li>
        <div class="mat-tree-node">
          <button mat-icon-button matTreeNodeToggle [attr.aria-label]="'toggle ' + node.name">
            <mat-icon class="mat-icon-rtl-mirror">
              {{ nestedTreeControl.isExpanded(node) ? 'expand_more' : 'chevron_right' }}
            </mat-icon>
          </button>
          <span class="ft-14-600 key-name">{{ node.key }}</span>
          <ng-container *ngIf="keyEditMode">
            <mat-icon class="icon" (click)="openAddNodeDialog(node)"> add </mat-icon>
            <mat-icon class="icon" (click)="openEditNodeDialog(node)">edit</mat-icon>
            <mat-icon class="icon" (click)="deleteNode(node)">delete_outline</mat-icon>
          </ng-container>
        </div>
        <ul [class.node-tree-invisible]="!nestedTreeControl.isExpanded(node)">
          <ng-container matTreeNodeOutlet></ng-container>
        </ul>
      </li>
    </mat-nested-tree-node>
  </mat-tree>
</div>
